MAC Token Type
==============

> Please note that this token type is based on the following [IETF specification, draft version 2](https://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-02).

The `MAC Token Type` allow clients to sign their requests using a shared algorithm/key generated by the authorization server.

Examples:

```php
use OAuth2\Token\MacToken;

$mac_token = new MacToken();

$token_type_manager->addTokenType($mac_token); // We suppose that $token_type_manager is an instance of a `OAuth2\Token\TokenTypeManagerInterface`.
```

Now, when access tokens are issued, additional values are set:

```json
{
    "access_token":"SlAV32hkKG",
    "token_type":"mac",
    "expires_in":3600,
    "refresh_token":"8xLOxBtZp8",
    "mac_key":"adijq39jdlaska9asud",
    "mac_algorithm":"hmac-sha-1"
}
```

You can change the `mac_algorithm` parameter, length and the charset of the `mac_key` if needed:

```php
use OAuth2\Token\MacToken;

$mac_token = new MacToken();
$mac_token->setMacKeyCharset('ABCDEFGHIJKLMNOPQRSTUVWXYZ');
$mac_token->setMacKeyMinLength(40);
$mac_token->setMacKeyMaxLength(50);
$mac_token->setMacAlgorithm('hmac-sha-256');

$token_type_manager->addTokenType($mac_token);
```

Examples of clients requests are available in the [IETF specification, draft version 02 section 3.2](https://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-02#section-3.2).

For more security, you can change the validity period of the timestamp. By default it is 30 seconds.

```php
use OAuth2\Token\MacToken;

$mac_token = new MacToken();
$mac_token->setTimestampLifetime(10);

$token_type_manager->addTokenType($mac_token);
```
